@namespace NRZMyk.Components.Pages.SentinelEntryPage
@page "/cryo-view/sentinel-entries"
@attribute [Authorize(Roles = nameof(Role.SuperUser))]
@inject SentinelEntryService SentinelEntryService
@using NRZMyk.Services.ModelExtensions
@using NRZMyk.Services.Models
@using NRZMyk.Services.Services
@using NRZMyk.Services.Utils
@inherits  CryoViewBase

<h1>Kryo Asservierung - Sentinel Daten</h1>

@if (sentinelEntries == null)
{
    <p><em>Daten werden geladen...</em></p>
}
else
{
    <div class="form-group row">
        <div class="col-sm-3">
            Org Auswahl
        </div>
        <div class="offset-3 col-sm-6 text-right">
            <AuthorizeView Roles=@nameof(Role.SuperUser)>
                <Authorized>
                    <ExportButton />
                </Authorized>
            </AuthorizeView>
        </div>
    </div>

    <table class="table table-striped table-hover table-sm">
        <thead>
            <tr>
                <th>Sentinel Labornummer</th>
                <th>Kryobox</th>
                <th>Einsender Labornummer</th>
                <th>Material</th>
                <th>Probennahme</th>
                <th>Spezies</th>
                <th>Asservierung</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in sentinelEntries)
            {
                <tr>
                    <td>@item.LaboratoryNumber</td>
                    <td>@item.CryoBox</td>
                    <td>@item.SenderLaboratoryNumber</td>
                    <td>@item.MaterialOrOther()</td>
                    <td>
                        @if (item.SamplingDate.HasValue)
                        {
                            @item.SamplingDate.Value.ToShortDateString();
                        }
                    </td>
                    <td>@item.SpeciesOrOther()</td>
                    <td>TODO</td>
                    <td>
                        <a title="Asservieren" href="" @onclick="() => StoreClick(item.Id)" @onclick:preventDefault class="btn btn-success">
                            <i class="oi oi-data-transfer-download"></i>
                        </a>
                        <a title="Asservieren" href="" @onclick="() => StoreClick(item.Id)" @onclick:preventDefault class="btn btn-danger">
                            <i class="oi oi-data-transfer-upload"></i>
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
